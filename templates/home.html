{% extends "base.html" %}
{% block style %}
<style>
  .col {
    border: 2px solid green;
    padding: 10px;
    margin: 2px;
    background-color: #536397;
    color: white;
  }
  h2 {
    color: #68e1f2;
  }
</style>
{% endblock style %}
{% block javascript %}
<script>
    document.querySelector('.relays').addEventListener('click', fav);

    function fav(e) {
      const tgt = e.target;
      if (tgt.classList.contains('fa-toggle-on')) {
          console.log('Turn off relay: ' + tgt.parentNode.id);
          tgt.classList.replace('fa-toggle-on', 'fa-toggle-off');
      }
      else if (tgt.classList.contains('fa-toggle-off')) {
          console.log('Turn on relay: ' + tgt.parentNode.id);
          tgt.classList.replace('fa-toggle-off', 'fa-toggle-on');
      }
    }
</script>
{% endblock javascript %}
{% block content %}
<div class="container">
  <div class="row">
    <div class="col">
      <h2>Temps</h2>
        {% for sensor in sensors %}
            {{ sensor.name }}: {{ sensor.get_temp_f }}<br />
        {% endfor %}
    </div>
    <div class="col relays">
      <h2>Relays</h2>
        {% for relay in relays %}
            {{ relay.name }}:
            <span style="font-size: 2em;" class="relay" id="relay_{{ relay.id }}">
            {% if relay.get_state == True %}
                <i class="fas fa-toggle-on"></i>
            {% elif relay.get_state == False %}
                <i class="fas fa-toggle-off"></i>
            {% else %}
                <i class="fas fa-question-circle"></i>
            {% endif %}
            </span>
            <br />
        {% endfor %}
    </div>
    <div class="col">
      <h2>Pumps</h2>
        {% for pump in pumps %}
            <h3>{{ pump.name }}</h3>
            {% for k, v in pump.get_status.items %}
                {{ k }}: {{ v }}<br />
            {% endfor %}
            <span class="fa-layers fa-fw fa-2x">
              <i class="far fa-circle"></i>
              <strong class="fa-layers-text" data-fa-transform="shrink-6">1</strong>
            </span>
            <span class="fa-layers fa-fw fa-2x">
              <i class="far fa-circle"></i>
              <strong class="fa-layers-text" data-fa-transform="shrink-6">2</strong>
            </span>
            <span class="fa-layers fa-fw fa-2x">
              <i class="far fa-circle"></i>
              <strong class="fa-layers-text" data-fa-transform="shrink-9">QC</strong>
            </span>
        {% endfor %}
    </div>
  </div>
</div>
{% endblock content %}
